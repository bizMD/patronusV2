<!DOCTYPE html>

<html>
<head>
  <title>Get All Dynamic Views</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="public/stylesheets/normalize.css" />
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div class="container">
    <div class="page">

      <div class="header">
        
          
          <h1 id="get-all-dynamic-views">Get All Dynamic Views</h1>

          
        

        
          <div class="toc">
            <h3>Table of Contents</h3>
            <ol>
              
                
                <li>
                  <a class="source" href="Cakefile.html">
                    Cakefile
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="remedyWS.html">
                    remedyWS.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="DB.html">
                    DB.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="timer.html">
                    timer.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="delete_all.html">
                    delete_all.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="delete_one_dataset.html">
                    delete_one_dataset.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="get_all_views.html">
                    get_all_views.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="get_one_view.html">
                    get_one_view.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="post_one_view.html">
                    post_one_view.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="put_one_dataset.html">
                    put_one_dataset.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="delete_all.html">
                    delete_all.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="delete_one_ws.html">
                    delete_one_ws.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="delete_one_ws_action.html">
                    delete_one_ws_action.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="get_all_WSDL_files.html">
                    get_all_WSDL_files.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="get_one_WSDL_file.html">
                    get_one_WSDL_file.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="get_one_WSDL_method.html">
                    get_one_WSDL_method.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="insert_WSDL_dataset.html">
                    insert_WSDL_dataset.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="upload_WSDL_file.html">
                    upload_WSDL_file.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="put_one_ws.html">
                    put_one_ws.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="put_one_ws_action.html">
                    put_one_ws_action.coffee
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="server.html">
                    server.coffee
                  </a>
                </li>
              
            </ol>
          </div>
        
      </div>

      
        
        <p>This route is designed to return all the dynamic views installed in the database.</p>

        
      
        
        <h2 id="requiring-dependencies">Requiring Dependencies</h2>

        
      
        
        <p>Require the modules we need for this class.</p>

        
          <div class='highlight'><pre>
<span class="hljs-built_in">require</span> <span class="hljs-string">'sugar'</span></pre></div>
        
      
        
        <h2 id="route-definition">Route Definition</h2>

        
      
        
        <p>This will return the headers with HTTP 200 Status Code, and a JSON content type. Afterwards, it will take collection, get all the dynamic views, and return all of them.</p>

        
      
        
        <p>It uses SugarJS to check if there are no dynamic views, and if there are none, to return an empty array.</p>

        
          <div class='highlight'><pre><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-params">([rq, rs, nx], db)</span> -&gt;</span>
	rs.writeHead <span class="hljs-number">200</span>, {<span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>}

	<span class="hljs-built_in">console</span>.log <span class="hljs-string">'Preparing the collection...'</span>
	datasets = db.getCollection <span class="hljs-string">'datasets'</span>
	
	<span class="hljs-keyword">if</span> Object.equal datasets.DynamicViews, [] <span class="hljs-keyword">then</span> rs.write <span class="hljs-string">'[]'</span>
	<span class="hljs-keyword">else</span> rs.write <span class="hljs-string">"{\"name\": \"<span class="hljs-subst">#{name}</span>\", \"view\": \"<span class="hljs-subst">#{filterPipeline}</span>\"}"</span> <span class="hljs-keyword">for</span> {name, filterPipeline} <span class="hljs-keyword">in</span> datasets.DynamicViews

	<span class="hljs-built_in">console</span>.log <span class="hljs-string">'Ending the reponse...'</span>
	rs.end()
	nx()</pre></div>
        
      
      <div class="fleur">h</div>
    </div>
  </div>
</body>
</html>
